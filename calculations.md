Ты прав — без формул это не ТЗ, а вдохновляющий тост. Ниже даю набор рабочих формул для v1 (которые реально можно закодить и получить предсказуемые кривые), плюс что считать входом, что получается на выходе, и где нужны коэффициенты/допущения.

Буду честен: для звукоснимателя “катушка в поле магнитов + струна” идеально точной аналитики без FEM нет, но очень полезный инженерный калькулятор делается на комбинации:
	1.	точных формул для R/L/нагрузки/трансформатора,
	2.	приличных аппроксимаций для Cp и магнитного поля,
	3.	“coupling factors”, которые позже можно калибровать по измерениям.

⸻

0) Нотация и единицы

Внутри ядра всё в SI:
	•	длины: m (в UI mm → m)
	•	площадь: m²
	•	индуктивность: H
	•	ёмкость: F
	•	сопротивление: Ω
	•	поле: T
	•	частота: Hz
Константа: \mu_0 = 4\pi \cdot 10^{-7}\ \text{H/m}

⸻

1) Геометрия катушки → длина провода

1.1 Средняя длина витка

Для “почти круглой” катушки:
	•	r_{mean} = \dfrac{r_{in}+r_{out}}{2}
	•	l_{turn} \approx 2\pi r_{mean}

Для прямоугольной (ширина w, длина l):
	•	l_{turn} \approx 2(w + l) (в первом приближении)

1.2 Общая длина провода
	•	L_{wire} \approx N \cdot l_{turn}
(в v1 можно добавить поправку на рост витков по слоям через небольшой коэффициент 1.02–1.10, или точнее считать по слоям, если ты задаёшь число слоёв и шаг.)

⸻

2) Сопротивление катушки R_{dc}

2.1 Площадь сечения провода
	•	A_{wire} = \pi\left(\dfrac{d_{cond}}{2}\right)^2
где d_{cond} — диаметр меди, без лака.

2.2 DC сопротивление
	•	R_{dc}(T) = \rho(T)\dfrac{L_{wire}}{A_{wire}}

Температурная поправка для меди:
	•	\rho(T)=\rho_{20}\left[1+\alpha(T-20^\circ C)\right]
	•	\rho_{20} \approx 1.724\cdot 10^{-8}\ \Omega\cdot m
	•	\alpha \approx 0.00393\ /\ ^\circ C

⸻

3) Индуктивность катушки L (air-core)

Для многослойной катушки в гитарном звукоснимателе чаще всего удобно использовать формулу Уилера (Wheeler). Она эмпирическая, но удивительно годная.

3.1 Wheeler для многослойной катушки (круглая)

В “дюймовой” форме она самая известная:

L(\mu H) \approx \frac{r^2 N^2}{9r+10l}

где r — средний радиус катушки (inches), l — длина/высота намотки (inches).
В коде:
	•	переводишь mm → inches,
	•	считаешь L в µH,
	•	переводишь в H.

Если катушка не круглая — можно использовать “эквивалентный радиус” по площади окна намотки:
	•	A = \pi r_{eq}^2 \Rightarrow r_{eq}=\sqrt{A/\pi}

3.2 Соленоид (для сравнения/упрощения)

Если хочешь более “физическую” формулу:
L \approx \mu_0 \frac{N^2 A}{l}
Она хуже для реальной геометрии pickup, но хороша как fallback и для sanity-check.

⸻

4) Паразитная ёмкость катушки C_p

Здесь нет одной “красивой” формулы, потому что это геометрия + диэлектрик + стиль намотки. Для v1 рекомендую модель с параметрами, но всё равно с физическим смыслом.

4.1 Модель v1: ёмкость ~ числу соседних контактов

C_p \approx k_{wind}\cdot N \cdot C_{turn}

Где:
	•	k_{wind} зависит от типа намотки:
	•	layered: больше контактов → выше k
	•	scatter: меньше контактов → ниже k
	•	C_{turn} — “типовая” ёмкость одного витка с соседями, зависит от:
	•	толщины изоляции,
	•	packing factor,
	•	геометрии.

Практически в UI:
	•	задаёшь windingStyle → выбираешь k_{wind} из таблицы,
	•	задаёшь insulationType → выбираешь базовый C_{turn} (или множитель),
	•	добавляешь множитель packing.

Это даст правдоподобную тенденцию: больше витков/плотнее/слойнее → выше Cp.

⸻

5) Собственный резонанс катушки f_0

f_0 = \frac{1}{2\pi\sqrt{L C_p}}

Это один из главных графиков: он объясняет “почему темнеет” при росте N.

⸻

6) Импеданс катушки как RLC

Минимальная модель: R и L последовательно, а C_p параллельно всей серии.
	•	Серийная часть: Z_{RL} = R + j\omega L
	•	Параллельная ёмкость: Z_C = \frac{1}{j\omega C_p}

Эквивалент:
Z_{coil} = \left(\frac{1}{Z_{RL}}+\frac{1}{Z_C}\right)^{-1}

Где \omega=2\pi f.

⸻

7) Добротность Q

Вокруг резонанса часто достаточно:
Q \approx \frac{\omega_0 L}{R_{ac}}

В v1 можно взять R_{ac}\approx R_{dc}.
В v2 добавишь skin/proximity эффекты, но для частот гитары и тонкого провода это обычно не катастрофа.

⸻

8) Нагрузка: потенциометры, тон-контур, кабель, вход усилителя

8.1 Кабель как ёмкость к земле

C_{cable} = C_{per\_m}\cdot length

8.2 Вход усилителя как R_{in} параллельно (обычно 1 MΩ)

Потенциометр громкости тоже как эффективное сопротивление к земле (приближённо). Для v1:
	•	R_{load} = R_{in} \parallel R_{vol}

8.3 Общая нагрузка катушки

Типовая схема: катушка → (параллельно) кабельная ёмкость и нагрузка.
Z_{load} = \left(\frac{1}{R_{load}} + j\omega C_{cable}\right)^{-1}
Дальше система:
Z_{total} = Z_{coil} \parallel Z_{load}
АЧХ по напряжению можно оценивать как делитель (если есть источник/внутр. сопротивление).

⸻

9) Магнитное поле (v1 без FEM)

Тут две разумные опции.

9.1 Самая простая: “B@distance” как табличная/параметризованная кривая
	•	Для каждого типа магнита (AlNiCo5, ferrite, NdFeB) задаёшь базовую кривую/коэффициент.
	•	Пользователь крутит расстояние → получаем B.

Это быстро и стабильно для UI.

9.2 Чуть более физично: осевое поле цилиндрического магнита

Для цилиндра радиуса R, толщины t, на оси на расстоянии z (упрощённо через эквивалент намагниченности/Br). Часто используют форму типа:

B(z) \approx \frac{B_r}{2}\left(\frac{z+t}{\sqrt{(z+t)^2+R^2}} - \frac{z}{\sqrt{z^2+R^2}}\right)

Это даёт реалистичный спад с расстоянием.

9.3 Градиент поля (важен для чувствительности)

\frac{dB}{dz} \approx \frac{B(z+\Delta)-B(z-\Delta)}{2\Delta}
(численно, \Delta например 0.1 мм)

⸻

10) Индуцированный сигнал (самая честная “основа”)

Базовый закон:
e(t) = -N \frac{d\Phi}{dt}
\Phi(t) \approx A_{eff}\cdot B(x(t))\cdot k_{coupling}
	•	A_{eff} — эффективная площадь катушки (или часть, которую реально “прошивает” поле)
	•	k_{coupling}\in[0,1] — тот самый коэффициент “насколько хорошо система сцеплена”

Если струна колеблется x(t)=x_0\sin(\omega t), то:
\frac{d\Phi}{dt} \approx A_{eff} k_{coupling}\frac{dB}{dx}\frac{dx}{dt}
\frac{dx}{dt} = \omega x_0 \cos(\omega t)

Отсюда амплитуда (порядок величины):
E_{peak} \approx N\cdot A_{eff}\cdot k_{coupling}\cdot \left|\frac{dB}{dx}\right|\cdot \omega x_0

Это шикарно для графика “Output vs distance”: при увеличении расстояния падают и B, и \frac{dB}{dx}.

⸻

11) Трансформатор

11.1 Идеальный коэффициент

n = \frac{N_s}{N_p}
\frac{V_s}{V_p} \approx n,\quad \frac{I_s}{I_p}\approx \frac{1}{n}

11.2 Отражённая нагрузка на первичку

Z_{ref} = \left(\frac{N_p}{N_s}\right)^2 Z_{load}

Это ключевая формула для твоей идеи “мало витков на pickup + трансформатор”: трансформатор меняет, какую нагрузку видит катушка.

11.3 Индуктивность первички через сердечник

L_p \approx \mu_0 \mu_{eff}\frac{N_p^2 A_e}{l_e}

Если есть зазор, \mu_{eff} падает (можно считать через магнитное сопротивление, но для v1 достаточно табличного/эмпирического \mu_{eff}).

11.4 Насыщение сердечника (синус)

Классическая формула трансформатора:
B_{peak} \approx \frac{V_{rms}}{4.44 f N_p A_e}
Условие “не в насыщении”:
B_{peak} < B_{sat}\cdot margin

11.5 Потери в сердечнике (если хочешь “оценочно”)

Steinmetz:
P \approx k f^a B^b
Для v1 можно сделать “low/med/high” по таблицам для материала, если нет точных k,a,b.

⸻

12) Какие графики строим строго из этих формул
	1.	Rdc vs N (точно, физика)
	2.	L vs N (Wheeler/solenoid)
	3.	Cp vs N / packing / windingStyle (модельная, но полезная)
	4.	f0 vs N (точно из L,Cp)
	5.	|Z| и phase vs f (точно из RLC)
	6.	B vs distance (таблично/аналитически)
	7.	dB/dx vs distance (численно)
	8.	Output index vs distance (из E_{peak})
	9.	С/без трансформатора: Bode magnitude/phase (из цепей + Z_ref)

⸻

Важно: как это оформить в ТЗ, чтобы разработчик не “додумывал”

В спецификации к приложению нужно прямо написать:
	•	какие формулы используются в Model v1.0,
	•	какие параметры являются калибровочными коэффициентами (например k_{coupling}, k_{wind}, C_{turn}),
	•	какие формулы “optional/v2”.

Если хочешь, я следующим сообщением оформлю это как раздел “Physics Model Specification v1.0” в стиле настоящей инженерной документации:
	•	таблица Inputs → Symbols → Units → Ranges,
	•	таблица Outputs → Formula,
	•	и псевдокод функций computeCoil() / computeSystemResponse() / computeMagnetField() (TypeScript-ready).
